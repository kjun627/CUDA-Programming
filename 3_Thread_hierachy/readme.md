## CUDA Thread Hierarchy
CUDA의 Thread Hierarchy 는 스레드, 워프, 블록, 그리드로 네개의 계층을 가짐.

### Tread
CUDA Thread hierarchy 중 가장 작은 단위로 CUDA 에서 연산을 수행하거나 **CUDA 코어를 사용하는 기본단위**
작성한 **커널 코드는 모든 스레드에 공유되며 각 스레드가 독립적으로 커널 코드를 수행**

### Wrap
32개의 Thread를 묶은 하나의 묶음 -> Wrap. CUDA의 기본 수행 단위이다.(한 워프에 속한 스레드들은 하나의 제어 장치에 의해 제어됨. SMIT 의 멀티 스레드의 단위가 되는게 바로 Wrap) 하나의 instruction 에 따라 32개의 스레드가 동시에 움직임.

### Block
Block or Thread Block은 스레드들의 집합. 블록은 스레드에 ID 를 부여하며, 각 블록에 포함된 각각 스레드는 자신만의 고유한 스레드 번호 (Thread ID) 를 가진다. (동일 블록 내에서는 동일한 ID를 가지는 스레드가 없음 , 다른 블록과는 겹칠 수 있음) 또한 블록 역시 자신의 고유한 블록 ID 가 있으며, 우리가 원하는 스레드를 정확히 지칭하기 위해서는 블록의 번호와 스레드 번호를 모두 사용해야함.

### 그리드

CUDA Thread hirarchy 에서 가장 상위 단계. 여러개의 블록을 포함하는 블록들의 그룹. 하나의 그리드에 포함된 블록들은 각각 고유한 블록번호를 가지고, 그리드내 블록은 3차원까지의 형태로 배치 될 수 있음. **커널이 호출되면 그리드가 생성이 된다. 즉 하나의 그리드는 하나의 커널 호출과 1:1 대응이 되고, 해당 커널을 수행할 스레드들을 생성함.**

### Thread 번호와 워프의 구성 
워프는 연속된 32개의 스레드로 구성되는데, 이 연속에 관한 정의는 X, Y, Z의 순서로 결정됨. 즉 (0, 0, 0) ~ (0, 0, 31) 의 순서로 하나의 워프를 구성. 만약 X 의 길이가 워프보다 작다면 Y차원 번호가 낮은 순으로 연속성을 가지게 됨.
**워프를 구성하는 스레드를 정확히 인지 해야함(워프 수준에서 스레드들 사이의 작업을 분배할 때 중요함)**

## 그리드 및 블록읯 최대 크기 제한
### 그리드 크기
그리드는 최대 3차원 형태로 구성할 수 있음. X차원의 최대 길이는 사실상 제한이 없다고 봐도 되고, (Y,Z) 차원의 경우 최대 크기가 65535로 제한된다.

### 블록의 크기
블록은 최대 3차원 형태로 구성될 수 있음. x,y 차원의 최대 크기는 1024이고 z차원의 최대 크기는 64 임. 최대 크기를 꼭 기억해둘 것. **블록 하나가 가질 수 있는 최대 스레드의 수는 1024개** . 최대 스레드 수를 간과하고 블록 설계하면 커널 실행 자체가 이루어지지 않음. 블록이 가지는 스레드의 수 x,y,z 크기의 곱 

## 커널 호출에 관하여
스레드 레이아웃은 스레드의 배치 형태를 지칭함. 그리드와 블록으로 정의된다. 스레드 레이아웃은 커널 호출 시 설정해야하고, 커널을 호출할 때 사용한 문법을 통해 전달됨.
```C
kernel<<<그리드 형태, 블록형태>>>()
```
스레드 레이아웃은 구조체 변수인 dim3 를 사용해서도 지정할 수 있음.
```C
Dim3 dimGrid(4, 1, 1)
Dim3 dimBlock(8, 1, 1)
kernel<<<dimGrid, dimBlock>>>()
```